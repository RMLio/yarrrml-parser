# Explicit create, update and delete.
# Although the source is the same file, changes are made explicit in
# different JSON fields, thus we need 3 sources with another iterator.

prefixes:
  ex: http://example.com/

sources:
  source-create:
    access: base.json
    referenceFormulation: jsonpath
    iterator: $.addition[*]

mappings:
  sensor-reading:
    sources:
      - ['base.json~jsonpath', '$.*']
    subjects: ex:sensor/$(sensor)
    po:
      - [ex:pressure, $(pressure)]
      - [ex:temperature, $(temperature)]

    changeDetection:
      create:
        explicit: true
        # The original source gets replaced with a reference to 'source-create'
        mappingRemove: sources
        mappingAdd:
          sources: source-create
